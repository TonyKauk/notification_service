# Сервис уведомлений

## Описание
Сервис управления рассылками  и получения статистики через API и
административный интерфейс. Основные возможности:
- Добавление, редактирование и удаление клиентов
- Добавление, редактирование и удаление рассылок
- Запуск рассылок в назначенный интервал времени
- Сбор статистики о выполненных рассылках
- Административный интерфейс

## Технологии
- Python 3.11.0
- Django 4.2.9
- Django REST Framework 3.14.0
- Celery 5.3.6
- Redis 7.2.4

## Запуск проекта

### Установите Redis:
```https://redis.io/docs/install/install-redis/```

### Скопируйте содержимое репозитория:
```git clone https://gitlab.com/for_interviews/notification_service.git```

### Перейдите в скопированную папку:
```сd notification_service```

### Создайте и активируйте виртуальное окружение:
```python3 -m venv env``` \
```source env/bin/activate```

### Установите pip:
```python3 -m pip install --upgrade pip```

### Установите все зависимости из requirements.txt:
```pip install -r requirements.txt```

### Задайте SECRET_KEY:
Чтобы сгенерировать SECRET_KEY  откройте терминал Django командой: \
```python3 manage.py shell``` \
и выполните следующие команды:\
```from django.core.management.utils import get_random_secret_key```\
```print(get_random_secret_key())```\
cкопируйте сгенерированный SECRET_KEY из консоли

В папку содержащую файл ```manage.py``` добавьте файл ```.env``` и внесите\
в него следующую строку:\
```SECRET_KEY=<SECRET_KEY из консоли, сгенерированный на прошлом шаге>```

### Добавьте в .env адрес нешнего API и токен:
```BASE_URL=<URL в формате https://www.api.com/v1/send>``` \
```TOKEN=<JWT token, c обозначением "Bearer">```

### Выполните миграции:
В папке с файлом ```manage.py``` выполните команду\
```python3 manage.py migrate```

### Запустите сервер Django:
В папке с файлом ```manage.py``` выполните команду\
```python3 manage.py runserver```

### Запустите сервер Redis:
```redis-server```

### Запустите сервер Celery Worker:
```celery -A notification_service worker -l info```

### Запустите сервер Celery Beat:
```celery -A notification_service beat -l info```

## Эндпоинты:
Документация в формате OpenApi представлена в файле ```schema.yaml``` \
Документация в формате Swagger доступна по адресу: ```http://127.0.0.1:8000/docs/``` \
Административная зона доступна по адресу: ```http://127.0.0.1:8000/admin/``` \
Для доступа в административную зону необходимо создать суперпользователя: \
```python3 manage.py createsuperuser``` \
и использовать его логин и пароль для авторизации
Для работы с клиентами запросы нужно отправлять на ```http://127.0.0.1:8000/api/clients/``` \
Для работы с рассылками запросы нужно отправлять на ```http://127.0.0.1:8000/api/mailings/``` 


## Дополнительно в проекте реализовано:
- Тестирование
- Администраторский интерфейс
- При возникновении ошибок на удаленном сервисе предпринимаются повторные
попытки по отправке до получения положительного результата
- Документация Swagger


## Автор
Антон Милов
